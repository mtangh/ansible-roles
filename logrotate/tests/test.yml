---
- hosts: localhost
  connection: local
  gather_facts: no

  tags:
    default

  vars:
    os_spec_os_family: redhat
    os_spec_os_distribution: centos
    os_spec_os_version: "6.7"
    os_spec_os_major_version: 6

  roles:
  - test-setup
  - { role: ../.. }
  - test-teardown

- hosts: localhost
  connection: local
  gather_facts: no

  tags:
    default-extend

  vars:
    os_spec_os_family: redhat
    os_spec_os_distribution: centos
    os_spec_os_version: "6.7"
    os_spec_os_major_version: 6

    logrotate_conf_default:
      cycle: weekly
      rotate: 8
      size: 1024M
      minsize: 1M
      dateext: yes
      dateformat: '%Y%m%d'
      compress: yes
      compressext: .gz
      delaycompress: yes
      missingok: yes
      ifempty: yes
      create:
        mode: 0644
        owner: root
        group: wheel

    logrotate_logfiles_appends:
    - name: httpd
      logfiles: '/var/log/httpd/*log'
      missingok: yes
      ifempty: no
      sharedscripts: yes
      postrotate: '/sbin/service httpd reload >/dev/null 2>/dev/null ||true' 

  roles:
  - test-setup
  - { role: ../.., tags: ['logrotate','logrotate-logfile-extend'] }
  - test-teardown

