---
# test-setup tasks file

- name: test-setup | create directories for test
  command:
    mkdir -p "{{ prefix_dir|d('') }}{{ item }}"
    creates={{ prefix_dir|d('') }}{{ item }}
  with_items:
  - /etc/httpd/conf
  - /etc/httpd/conf.d
  when: test_run is defined
        and prefix_dir is defined
  tags:
  - '[unit_test_setup]'

- name: test-setup | copy files to httpd/conf
  copy:
    src: "{{ item }}"
    dest: "{{ prefix_dir|d('') }}/etc/httpd/conf/"
  with_items:
  - "{{ os_spec_os_family }}/httpd.conf"
  when: test_run is defined
        and prefix_dir is defined
  tags:
  - '[unit_test_setup]'

- name: test-setup | copy files to httpd/conf.d
  copy:
    src: "{{ item }}"
    dest: "{{ prefix_dir|d('') }}/etc/httpd/conf.d/"
  with_items:
  - "{{ os_spec_os_family }}/ssl.conf"
  - "{{ os_spec_os_family }}/welcome.conf"
  when: test_run is defined
        and prefix_dir is defined
  tags:
  - '[unit_test_setup]'

